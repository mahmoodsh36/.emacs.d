#!/bin/sh

file_path() {
    case "$1" in
        .*)
            echo "$PWD/$(echo "$1" | cut -c2-)"
            ;;
        */*)
            echo "$1"
            ;;
        *)
            echo "$PWD/$1"
            ;;
    esac
}

while read file
do
    case "$1" in
        "x")
            image_index="$(expr "$(find ~/media/images/toffee/ -type f | sed 's,^.*/image,,' | cut -d '_' -f1 | sort -n | tail -1)" + 1)"
            filepath="$(file_path "$file")"
            parent_dir="$(echo "$filepath" | rev | cut -d '/' -f2 | rev)"
            original_filename="$(echo "$filepath" | rev | cut -d "/" -f1 | rev)"
            if [ ! -d "$HOME/media/images/toffee/$parent_dir" ]; then
                mkdir "$HOME/media/images/toffee/$parent_dir"
            fi
            mv "$file" "/home/$USER/media/images/toffee/$parent_dir/image${image_index}_$original_filename"
            ;;
        "y")
            echo $file | tr -d "\n" | xclip -selection c
            notify-send "$file"
            ;;
        "w")
            hsetroot -full "$file"
            #wal -i "$file"
            cp "$file" ~/.cache/wallpaper
            #/usr/bin/pywal_awesome_colors.sh
            #/usr/bin/dunst_pywal.sh
            #sudo oomoxify-cli -s /usr/share/spotify/spotify-client/Apps -g /home/mahmooz/.cache/wal/colors-oomox
            #sed -i '/SchemeUrg/d' ~/.cache/wal/colors-wal-dwm.h
            #sudo make install clean -C ~/workspace/dwm
            #notify-send "wallpaper colors generated"
            ;;
        "a")
            mv "$file" ~/media/images/wal/ignore/
            ;;
        "d")
            mv "$file" ~/.local/share/Trash/files
            ;;
        "s")
            mv "$file" ~/media/images/wal/
            ;;
        "r")
            mv "$file" `echo $file | dmenu -it "$file"`
            ;;
        "y")
            echo "$file" | xclip -selection c
            ;;
        "D")
            rm "$file"
            ;;
        "2")
            mv "$file" ~/media/2
            ;;
    esac
done
